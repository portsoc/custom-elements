<!doctype html>
<title>example</title>

<h1>example</h1>
<canvas id="canvas" width="300" height="300"></canvas>
<canvas id="c2" width="300" height="300"></canvas>

<script>
  const ctx = window.canvas.getContext("2d");
  const ctx2 = window.c2.getContext("2d");

  const w = window.canvas.width;
  const h = window.canvas.height;

  ctx.globalAlpha = 0.5;

  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.lineTo(300, 300);
  ctx.strokeStyle = "red";
  ctx.closePath;
  ctx.stroke();

  let data;

  function step(timestamp) {
    changes = true;
    data = ctx.getImageData(0, 0, w, h);

    // loop from the bottom to the top
    // moving the upper pixel down if it is
    // non transparent and the pixel below is transparent.

    for (let y = h; y > 1; y--) {
      for (let x = w; x > 1; x--) {

        let me = y * w + x;
        let other = (y - 1) * w + x;

        data.data[other] = data.data[me];

      }
    }
    ctx2.putImageData(data, 0, 0, 0, 0, w, h);
    window.requestAnimationFrame(step);
  }
  window.requestAnimationFrame(step);
</script>
